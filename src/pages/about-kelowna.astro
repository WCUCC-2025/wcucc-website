---
import Navbar from '../components/Nav.astro';
---

<div class="absolute w-screen bg-white">
  <Navbar />
  <!-- DESIGN IDEA => Magic scroll implementation for places to visit-->
  <!-- Ideal Image size: 1024px width x 384px height -->
  <!-- Recommended aspect ratio would be 2.67:1 -->
  <!-- Carousel Container with limited height and width -->
  <div class="relative w-full h-[60vh] flex justify-center">
    <!-- Carousel Wrapper -->
    <div id="carousel" class="w-full h-full flex flex-col justify-center overflow-hidden relative object-cover">
      <!-- Carousel Images -->
      <div id="carouselInner" class="flex h-full transition-transform duration-300 ease-in-out">
        <img src="/pic2.jpg" alt="Picture 1" class="w-full h-full object-cover flex-shrink-0">
        <img src="/pic2.jpg" alt="Picture 2" class="w-full h-full object-cover flex-shrink-0">
        <img src="/pic2.jpg" alt="Picture 3" class="w-full h-full object-cover flex-shrink-0">
      </div>
    </div>

    <!-- Left Arrow -->
    <button id="prevButton" class="absolute top-1/2 left-4 transform -translate-y-1/2 bg-gray-800 bg-opacity-70 text-white p-2 rounded-full shadow-lg hover:bg-opacity-100 hover:scale-110 transition-all">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
      </svg>
    </button>

    <!-- Right Arrow -->
    <button id="nextButton" class="absolute top-1/2 right-4 transform -translate-y-1/2 bg-gray-800 bg-opacity-70 text-white p-2 rounded-full shadow-lg hover:bg-opacity-100 hover:scale-110 transition-all">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
    </button>
  </div>

  <div class="relative w-full h-80 bg-gray-300 font-rubik">
    <div class="absolute top-4 left-4 text-4xl font-bold ml-10 mt-10 animate-item from-left">
      <div>WELCOME TO</div>
      <div>KELOWNA</div>
    </div>
    <div class="absolute bottom-4 right-4 text-4xl font-bold text-right mr-10 mb-5 animate-item from-right">
      <div>WHERE NATURE</div>
      <div>MEETS THE CITY</div>
      <a href="#mountain-knox" class="block mt-4 text-2xl text-blue-500 underline items-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
        </svg>
        Places to visit
      </a>
    </div>
  </div>

  <!-- KNOX Mountain -->
  <div id="mountain-knox" class="flex w-full h-screen bg-gray-600">
    <div class="w-2/3 flex items-center justify-center ml-40">
      <div class="w-2/3 h-1/3 bg-amber-900 ml-20 m-auto animate-item from-left"></div>
      <div class="text-center ml-20 animate-item from-right">
        <h2 class="text-4xl font-bold text-left">KNOX MOUNTAIN</h2>
        <p class="mt-4 text-xl text-left">This is some placeholder text information that goes alongside the picture of Knox Mountain.</p>
      </div>
    </div>
  </div>

  <!-- Okanagan lake -->
  <div id="okanagan-lake" class="flex w-full h-screen bg-gray-300">
    <div class="w-2/3 flex items-center justify-center ml-40">
      <div class="text-center ml-20 animate-item from-left">
        <h2 class="text-4xl font-bold text-left">OKANAGAN LAKE</h2>
          <p class="mt-4 text-xl text-left">This is some placeholder text information that goes alongside the picture of Knox Mountain.</p>
        </div>
        <div class="w-2/3 h-1/3 bg-amber-900 ml-20 animate-item from-right"></div>
      </div>
    </div>
  </div>

<script>
  // Ensure the script runs after the DOM has fully loaded
  document.addEventListener('DOMContentLoaded', function() {
    const carouselInner = document.getElementById('carouselInner');
    const images = carouselInner ? carouselInner.children : [];
    const totalImages = images.length;

    let currentIndex = 0;

    // Function to update the carousel position
    function updateCarouselPosition() {
      if (carouselInner) {
        const carouselWidth = carouselInner.clientWidth;
        const newTransformValue = -currentIndex * carouselWidth;
        carouselInner.style.transform = `translateX(${newTransformValue}px)`;
      }
    }

    // Event listeners for next and previous buttons
    document.getElementById('nextButton')?.addEventListener('click', () => {
      currentIndex = (currentIndex + 1) % totalImages; // Loop back to the first image
      updateCarouselPosition();
    });

    document.getElementById('prevButton')?.addEventListener('click', () => {
      currentIndex = (currentIndex - 1 + totalImages) % totalImages; // Loop to the last image
      updateCarouselPosition();
    });

    // Handle window resize to adjust position correctly
    window.addEventListener('resize', updateCarouselPosition);
  });

  function setupAnimations() {
    const animatedItems = document.querySelectorAll('.animate-item');
    
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('is-visible');
        } else {
          entry.target.classList.remove('is-visible');
        }
      });
    }, {
      threshold: 0.1
    });

    animatedItems.forEach(item => {
      observer.observe(item);
    });
  }

  // Run setup when the DOM is loaded
  document.addEventListener('DOMContentLoaded', setupAnimations);

  // Astro's way of ensuring the script runs after client-side navigation
  document.addEventListener('astro:page-load', setupAnimations);
</script>

<style>
  @import url('https://fonts.googleapis.com/css2?family=Rubik:wght@400;700&display=swap');

  .font-rubik {
    font-family: 'Rubik';
  }

  .animate-item {
    opacity: 0;
    transition: opacity 0.5s ease-out, transform 0.5s ease-out;
  }

  .animate-item.from-left {
    transform: translateX(-100px);
  }

  .animate-item.from-right {
    transform: translateX(100px);
  }

  .animate-item.is-visible {
    opacity: 1;
    transform: translateX(0);
  }
</style>